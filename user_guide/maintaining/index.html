

<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../production_deployment_with_own_proxy/">
      
      
        <link rel="next" href="../dataset_description/">
      
      
        
      
      
      <link rel="icon" href="../../imgs/logo/neurobagel_favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.3">
    
    
      
        <title>Maintaining a node - Neurobagel</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  <script defer data-domain="neurobagel.org" src="https://plausible.neurobagel.org/js/script.js"></script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="deep-purple" data-md-color-accent="amber">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#updating-the-neurobagel-services" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Neurobagel" class="md-header__button md-logo" aria-label="Neurobagel" data-md-component="logo">
      
  <img src="../../imgs/logo/neurobagel_logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Neurobagel
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Maintaining a node
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/neurobagel/documentation" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Welcome

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
  
    
  
  User guide

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../data_models/variables/" class="md-tabs__link">
          
  
  
    
  
  Data models

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../contributing/CONTRIBUTING/" class="md-tabs__link">
          
  
  
    
  
  Contributing

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../getting_help/" class="md-tabs__link">
        
  
  
    
  
  Getting help

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../glossary/" class="md-tabs__link">
        
  
  
    
  
  Glossary

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../cite/" class="md-tabs__link">
        
  
  
    
  
  Citing Neurobagel

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Neurobagel" class="md-nav__button md-logo" aria-label="Neurobagel" data-md-component="logo">
      
  <img src="../../imgs/logo/neurobagel_logo.png" alt="logo">

    </a>
    Neurobagel
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/neurobagel/documentation" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Welcome
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    User guide
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    User guide
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Running cohort queries
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Running cohort queries
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../public_nodes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Search the public nodes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../query_tool/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    How to use the query tool
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Querying the API directly
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" checked>
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Setting up your own Neurobagel node
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Setting up your own Neurobagel node
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../getting_started/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Getting started
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../production_deployment/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Production deployment
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../production_deployment_with_own_proxy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Production deployment with an existing proxy
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Maintaining a node
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Maintaining a node
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#updating-the-neurobagel-services" class="md-nav__link">
    <span class="md-ellipsis">
      
        Updating the Neurobagel services
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Updating the Neurobagel services">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#updating-the-neurobagel-docker-images" class="md-nav__link">
    <span class="md-ellipsis">
      
        Updating the Neurobagel Docker images
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#restarting-services-after-an-update" class="md-nav__link">
    <span class="md-ellipsis">
      
        Restarting services after an update
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#updating-the-data-in-your-graph" class="md-nav__link">
    <span class="md-ellipsis">
      
        Updating the data in your graph
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Updating the data in your graph">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#following-a-change-in-my-dataset" class="md-nav__link">
    <span class="md-ellipsis">
      
        Following a change in my dataset
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Following a change in my dataset">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#if-the-phenotypic-tabular-data-have-changed" class="md-nav__link">
    <span class="md-ellipsis">
      
        If the phenotypic (tabular) data have changed
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#if-only-the-imaging-data-have-changed" class="md-nav__link">
    <span class="md-ellipsis">
      
        If only the imaging data have changed
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#if-only-the-subjects-have-changed" class="md-nav__link">
    <span class="md-ellipsis">
      
        If only the subjects have changed
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#following-a-change-in-the-neurobagel-data-model" class="md-nav__link">
    <span class="md-ellipsis">
      
        Following a change in the Neurobagel data model
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#re-uploading-a-modified-dataset" class="md-nav__link">
    <span class="md-ellipsis">
      
        Re-uploading a modified dataset
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#updating-your-graph-backend-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      
        Updating your graph backend configuration
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Updating your graph backend configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#updating-existing-database-user-permissions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Updating existing database user permissions
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#resetting-your-graphdb-instance" class="md-nav__link">
    <span class="md-ellipsis">
      
        Resetting your GraphDB instance
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#environment-variables-reference" class="md-nav__link">
    <span class="md-ellipsis">
      
        Environment variables reference
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_4" >
        
          
          <label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Annotating your data
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Annotating your data
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dataset_description/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Preparing the dataset description
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../data_prep/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Preparing phenotypic data
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../annotation_tool/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Annotating phenotypic data
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../preparing_imaging_data/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Preparing imaging data
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cli/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Generating harmonized subject-level metadata
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Data models
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Data models
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data_models/variables/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Harmonized variables
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data_models/dictionaries/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Augmented BIDS data dictionaries
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data_models/graph_data/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Data files for Neurobagel graphs
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data_models/term_naming_standards/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Naming conventions for terms
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../data_models/communities/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Community vocabularies (beta)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Contributing
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Contributing
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/CONTRIBUTING/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    How to contribute
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/team/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Our team
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting_help/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Getting help
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../glossary/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Glossary
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cite/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Citing Neurobagel
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#updating-the-neurobagel-services" class="md-nav__link">
    <span class="md-ellipsis">
      
        Updating the Neurobagel services
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Updating the Neurobagel services">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#updating-the-neurobagel-docker-images" class="md-nav__link">
    <span class="md-ellipsis">
      
        Updating the Neurobagel Docker images
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#restarting-services-after-an-update" class="md-nav__link">
    <span class="md-ellipsis">
      
        Restarting services after an update
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#updating-the-data-in-your-graph" class="md-nav__link">
    <span class="md-ellipsis">
      
        Updating the data in your graph
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Updating the data in your graph">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#following-a-change-in-my-dataset" class="md-nav__link">
    <span class="md-ellipsis">
      
        Following a change in my dataset
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Following a change in my dataset">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#if-the-phenotypic-tabular-data-have-changed" class="md-nav__link">
    <span class="md-ellipsis">
      
        If the phenotypic (tabular) data have changed
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#if-only-the-imaging-data-have-changed" class="md-nav__link">
    <span class="md-ellipsis">
      
        If only the imaging data have changed
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#if-only-the-subjects-have-changed" class="md-nav__link">
    <span class="md-ellipsis">
      
        If only the subjects have changed
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#following-a-change-in-the-neurobagel-data-model" class="md-nav__link">
    <span class="md-ellipsis">
      
        Following a change in the Neurobagel data model
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#re-uploading-a-modified-dataset" class="md-nav__link">
    <span class="md-ellipsis">
      
        Re-uploading a modified dataset
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#updating-your-graph-backend-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      
        Updating your graph backend configuration
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Updating your graph backend configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#updating-existing-database-user-permissions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Updating existing database user permissions
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#resetting-your-graphdb-instance" class="md-nav__link">
    <span class="md-ellipsis">
      
        Resetting your GraphDB instance
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#environment-variables-reference" class="md-nav__link">
    <span class="md-ellipsis">
      
        Environment variables reference
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


  <h1>Maintaining a node</h1>

<p>Once your Neurobagel node is running and configured correctly,
there are some recurring tasks you may have to do to keep it operating correctly.</p>
<h2 id="updating-the-neurobagel-services">Updating the Neurobagel services</h2>
<h3 id="updating-the-neurobagel-docker-images">Updating the Neurobagel Docker images</h3>
<p>We are continuously improving Neurobagel tools and services,
so you may want to update your Neurobagel node to the latest version to benefit from new features and bug fixes.
We always publish our tools as <a href="https://hub.docker.com/u/neurobagel">Docker images on Docker Hub</a>.</p>
<p>Each Docker image has a <a href="https://semver.org/">semantic version</a> tag (vX.Y.Z), and also two rolling tags:</p>
<ul>
<li><code>latest</code> (the latest stable release). This is the default tag used in the Neurobagel <code>docker-compose.yml</code> file.</li>
<li><code>nightly</code> (the latest build from the main branch). This tag is only used for compatibility testing and should not be used in production.</li>
</ul>
<p>You can pull the most recent docker images for Neurobagel tools by running:</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>compose<span class="w"> </span>pull
</code></pre></div>
<details class="tip">
<summary>Not sure what version you have?</summary>
<p>Since <code>latest</code> is a rolling tag, each <code>latest</code> Docker image for a Neurobagel tool includes its corresponding semver number (vX.Y.X) as part of its Docker image labels.</p>
<p>You can find the labels for an image you have pulled in the image metadata, e.g.:
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>image<span class="w"> </span>inspect<span class="w"> </span>neurobagel/api:latest
</code></pre></div>
or, to view only the labels:
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>image<span class="w"> </span>inspect<span class="w"> </span>--format<span class="o">=</span><span class="s1">&#39;{{json .Config.Labels}}&#39;</span><span class="w"> </span>neurobagel/api:latest
</code></pre></div>
In either case, you should see something like this in the output:</p>
<p><div class="highlight"><pre><span></span><code><span class="w">    </span><span class="s2">&quot;Labels&quot;</span>:<span class="w"> </span><span class="o">{</span>
<span class="w">        </span><span class="s2">&quot;org.opencontainers.image.created&quot;</span>:<span class="w"> </span><span class="s2">&quot;https://github.com/neurobagel/api&quot;</span>,
<span class="w">        </span><span class="s2">&quot;org.opencontainers.image.revision&quot;</span>:<span class="w"> </span><span class="s2">&quot;01530f467e163f3dff595d3327bc60ba453de47d&quot;</span>,
<span class="w">        </span><span class="s2">&quot;org.opencontainers.image.version&quot;</span>:<span class="w"> </span><span class="s2">&quot;v0.3.1&quot;</span>
<span class="w">    </span><span class="o">}</span>
</code></pre></div>
where <code>"org.opencontainers.image.version"</code> refers to the version number.</p>
</details>
<h3 id="restarting-services-after-an-update">Restarting services after an update</h3>
<p>Whether you have updated the Docker images, the <a href="../production_deployment/">configuration</a>, or the <a href="#updating-the-data-in-your-graph">data</a>
of your Neurobagel node, you will need to restart the services to apply the changes.</p>
<p>To shut down your Neurobagel services,
navigate to the directory containing your deployment recipe and run:</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>compose<span class="w"> </span>down
</code></pre></div>
<p>Then, to start the services again:</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>compose<span class="w"> </span>up<span class="w"> </span>-d
</code></pre></div>
<div class="admonition tip">
<p class="admonition-title">For production deployments, you must specify the recipe filename</p>
<p>To relaunch services for a <a href="../production_deployment/#node"><code>node</code></a> or <a href="../production_deployment/#portal"><code>portal</code></a> deployment,
you must provide the production Docker Compose recipe filename explicitly using the <code>-f</code> option:</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>compose<span class="w"> </span>-f<span class="w"> </span>docker-compose.prod.yml<span class="w"> </span>up<span class="w"> </span>-d
</code></pre></div>
</div>
<h2 id="updating-the-data-in-your-graph">Updating the data in your graph</h2>
<p>The Neurobagel deployment recipe launches a dedicated graph database that stores the datasets for a single node.
The data in this graph database is loaded from the path specified in the
<a href="#environment-variables-reference"><code>LOCAL_GRAPH_DATA</code> environment variable</a>,
and can be changed at any time.</p>
<p>By default, the graph database will only contain an <a href="https://github.com/neurobagel/recipes/blob/main/data/example_synthetic_pheno-bids-derivatives.jsonld">example dataset called <code>BIDS synthetic</code></a>.</p>
<p>If you have followed the <a href="../getting_started/">initial setup</a> for deploying a Neurobagel node from our Docker Compose recipe,
replacing the existing data in your graph database with your own data (or updated data) is a straightforward process.</p>
<p>Once you have generated or updated the JSONLD files you want to upload, to update the data in your graph:</p>
<ol>
<li>
<p>Shut down the Neurobagel node, if it is already running</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>compose<span class="w"> </span>down
</code></pre></div>
</li>
<li>
<p>Update the data files in the directory specified by the <code>LOCAL_GRAPH_DATA</code> variable in <code>.env</code>, or simply change the path to a directory containing your JSONLD files.</p>
</li>
<li>
<p>(Re)start the Neurobagel node</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>compose<span class="w"> </span>up<span class="w"> </span>-d
</code></pre></div>
</li>
</ol>
<div class="admonition tip">
<p class="admonition-title">For production deployments, you must specify the recipe filename</p>
<p>To relaunch services for a production <a href="../production_deployment/#node"><code>node</code></a> deployment,
you must provide the production Docker Compose recipe filename explicitly using the <code>-f</code> option:</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>compose<span class="w"> </span>-f<span class="w"> </span>docker-compose.prod.yml<span class="w"> </span>up<span class="w"> </span>-d
</code></pre></div>
</div>
<p>Here are some other common scenarios where you might need to update the data in your graph:</p>
<h3 id="following-a-change-in-my-dataset">Following a change in my <em>dataset</em></h3>
<p>When using Neurobagel tools on a dataset that is still undergoing data collection,
you may need to update the Neurobagel annotations and/or graph-ready data for the dataset
when you want to add new subjects or measurements or to correct mistakes in prior data versions.</p>
<p>For any of the below types of changes, you will need to regenerate a graph-ready <code>.jsonld</code> file for the dataset which reflects the change.</p>
<h4 id="if-the-phenotypic-tabular-data-have-changed">If the phenotypic (tabular) data have changed</h4>
<p>If new variables have been added to the dataset such that there are new columns in the phenotypic TSV you previously annotated using Neurobagel's annotation tool, you will need to:</p>
<ol>
<li>
<p><strong>Generate an updated data dictionary</strong> by annotating the new variables in your TSV following the <a href="../annotation_tool/">annotation workflow</a></p>
</li>
<li>
<p><strong>Generate a new graph-ready data file</strong> for the dataset by <a href="../cli/">re-running the CLI</a> on your updated TSV and data dictionary</p>
</li>
</ol>
<h4 id="if-only-the-imaging-data-have-changed">If only the imaging data have changed</h4>
<p>If the BIDS data for a dataset have changed without changes in the corresponding phenotypic TSV (e.g., if new modalities or scans have been acquired for a subject), you have two options:</p>
<ul>
<li>If you still have access to the dataset's phenotypic JSONLD generated from the <code>pheno</code> command of the <code>bagel-cli</code> (step 1), you may choose to <a href="../cli/">rerun only the <code>bids</code> CLI command</a> on the updated BIDS directory.
This will generate a new graph-ready data file with updated imaging metadata of subjects.</li>
</ul>
<p>OR</p>
<ul>
<li><a href="../cli/">Rerun the CLI entirely (<code>pheno</code> and <code>bids</code> steps)</a> to generate a new graph-ready data file for the dataset.</li>
</ul>
<p><em>When in doubt, rerun both CLI commands.</em></p>
<h4 id="if-only-the-subjects-have-changed">If only the subjects have changed</h4>
<p>If subjects have been added to or removed from the dataset but the phenotypic TSV is otherwise unchanged (i.e., only new or removed rows, without changes to the available variables), you will need to:</p>
<ul>
<li><strong>Generate a new graph-ready data file</strong> for the dataset by <a href="../cli/">re-running the CLI</a> (<code>pheno</code> and <code>bids</code> steps) on your updated TSV and existing data dictionary</li>
</ul>
<h3 id="following-a-change-in-the-neurobagel-data-model">Following a change in the <em>Neurobagel data model</em></h3>
<p>As Neurobagel continues developing the data model, new tool releases may introduce breaking changes to the data model for subject-level information in a <code>.jsonld</code> graph data file.
Breaking changes will be highlighted in the release notes.</p>
<p><em>If you have already created <code>.jsonld</code> files for a Neurobagel graph database</em> but want to update your graph data to the latest Neurobagel data model following such a change, you can easily do so by <a href="../cli/">rerunning the CLI</a> on the existing data dictionaries and phenotypic TSVs for the dataset(s) in the graph.
This will ensure that if you use the latest version of the Neurobagel CLI to process new datasets (i.e., generate new <code>.jsonld</code> files) for your database, the resulting data will not have conflicts with existing data in the graph.</p>
<p>Note that if upgrading to a newer version of the data model, <strong>you should regenerate the <code>.jsonld</code> files for <em>all</em> datasets in your existing graph</strong>.</p>
<h3 id="re-uploading-a-modified-dataset">Re-uploading a modified dataset</h3>
<p>To allow easy (re-)uploading of the updated <code>.jsonld</code> for your dataset(s) to a graph database, we recommend making a copy of it in a central directory on your research data fileserver for storing local Neurobagel <code>jsonld</code> datasets.
Then, simply follow the steps for <a href="#updating-the-data-in-your-graph">uploading/updating a dataset in the graph database</a>.</p>
<h2 id="updating-your-graph-backend-configuration">Updating your graph backend configuration</h2>
<h3 id="updating-existing-database-user-permissions">Updating existing database user permissions</h3>
<p>If you want to change database access permissions (e.g., adding or removing access to a database) for an <em>existing</em> user in your GraphDB instance, you must do so manually.</p>
<p>Of note, in GraphDB, there is no straightforward REST API call to update a user's database access permissions without replacing the list of their existing database permissions (<code>"grantedAuthorities"</code>) entirely.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>You can verify a user's settings at any time with the following:
<div class="highlight"><pre><span></span><code>curl<span class="w"> </span>-u<span class="w"> </span><span class="s2">&quot;admin:NewAdminPassword&quot;</span><span class="w"> </span>http://localhost:7200/rest/security/users/DBUSER
</code></pre></div></p>
</div>
<p>Example: if user <code>DBUSER</code> was granted read/write access to database <code>my_db1</code> with the following command
(this command is run by default as part of <a href="https://github.com/neurobagel/recipes/blob/main/scripts/graphdb_setup.sh"><code>graphdb_setup.sh</code></a>):</p>
<div class="highlight"><pre><span></span><code>curl<span class="w"> </span>-X<span class="w"> </span>PUT<span class="w"> </span>--header<span class="w"> </span><span class="s1">&#39;Content-Type: application/json&#39;</span><span class="w"> </span>-d<span class="w"> </span><span class="s1">&#39;</span>
<span class="s1">{&quot;grantedAuthorities&quot;: [&quot;WRITE_REPO_my_db&quot;,&quot;READ_REPO_my_db&quot;]}&#39;</span><span class="w"> </span>http://localhost:7200/rest/security/users/DBUSER<span class="w"> </span>-u<span class="w"> </span><span class="s2">&quot;admin:NewAdminPassword&quot;</span>
</code></pre></div>
<p>To grant <code>DBUSER</code> read/write access to a second database <code>my_db2</code> (while keeping the existing access to <code>my_db1</code>),
you would rerun the above <code>curl</code> command with <em>all</em> permissions (existing and new) specified since the existing permissions list will be overwritten:</p>
<div class="highlight"><pre><span></span><code>curl<span class="w"> </span>-X<span class="w"> </span>PUT<span class="w"> </span>--header<span class="w"> </span><span class="s1">&#39;Content-Type: application/json&#39;</span><span class="w"> </span>-d<span class="w"> </span><span class="s1">&#39;</span>
<span class="s1">{&quot;grantedAuthorities&quot;: [&quot;WRITE_REPO_my_db1&quot;,&quot;READ_REPO_my_db1&quot;, &quot;WRITE_REPO_my_db2&quot;,&quot;READ_REPO_my_db2&quot;]}&#39;</span><span class="w"> </span>http://localhost:7200/rest/security/users/DBUSER<span class="w"> </span>-u<span class="w"> </span><span class="s2">&quot;admin:NewAdminPassword&quot;</span>
</code></pre></div>
<p>Similarly, to revoke <code>my_db1</code> access so <code>DBUSER</code> only has access to <code>my_db2</code>:</p>
<div class="highlight"><pre><span></span><code>curl<span class="w"> </span>-X<span class="w"> </span>PUT<span class="w"> </span>--header<span class="w"> </span><span class="s1">&#39;Content-Type: application/json&#39;</span><span class="w"> </span>-d<span class="w"> </span><span class="s1">&#39;</span>
<span class="s1">{&quot;grantedAuthorities&quot;: [&quot;WRITE_REPO_my_db2&quot;,&quot;READ_REPO_my_db2&quot;]}&#39;</span><span class="w"> </span>http://localhost:7200/rest/security/users/DBUSER<span class="w"> </span>-u<span class="w"> </span><span class="s2">&quot;admin:NewAdminPassword&quot;</span>
</code></pre></div>
<details class="tip">
<summary>Managing user permissions using the GraphDB Workbench</summary>
<p>If you are managing multiple GraphDB databases, the web-based administration interface for a GraphDB instance, the Workbench,
might be an easier way to manage user permissions than the REST API.
More information on using the GraphDB Workbench can be found <a href="https://graphdb.ontotext.com/documentation/10.0/workbench-user-interface.html">here</a>.</p>
</details>
<h3 id="resetting-your-graphdb-instance">Resetting your GraphDB instance</h3>
<p>Each Neurobagel node has its own GraphDB instance, which is used to store the graph data for the node.
If you want to reset your graph database and start again from scratch,
follow these steps:</p>
<ol>
<li>
<p>Ensure that your Neurobagel node is not running (i.e., shut down the Docker containers for the node).</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>compose<span class="w"> </span>down
</code></pre></div>
</li>
<li>
<p>Delete the Docker volume that contains the GraphDB data for your node.</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>volume<span class="w"> </span>rm<span class="w"> </span>neurobagel_node_graphdb_home
</code></pre></div>
<p>Replace <code>neurobagel_node_graphdb_home</code> with the name of the volume created for your node.
It is usually named <code>&lt;project_name&gt;_graphdb_home</code>
where <code>&lt;project_name&gt;</code> is the name of your Docker Compose stack
as defined in <code>COMPOSE_PROJECT_NAME</code> in your <code>.env</code> file.</p>
<details class="tip">
<summary><code>docker volume ls</code> lists all volumes on your system</summary>
<p>You can use the <code>docker volume ls</code> command to list all volumes on your system.
This will help you identify the name of the volume that was created for your Neurobagel node.</p>
</details>
</li>
<li>
<p>Launch your Neurobagel node again.</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>compose<span class="w"> </span>up<span class="w"> </span>-d
</code></pre></div>
<div class="admonition tip">
<p class="admonition-title">For production deployments, you must specify the recipe filename</p>
<p>To relaunch services for a production <a href="../production_deployment/#node"><code>node</code></a> deployment,
you must provide the production Docker Compose recipe filename explicitly using the <code>-f</code> option:</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>compose<span class="w"> </span>-f<span class="w"> </span>docker-compose.prod.yml<span class="w"> </span>up<span class="w"> </span>-d
</code></pre></div>
</div>
</li>
</ol>
<p>Some examples of when you might want to do this:</p>
<ul>
<li>You started but did not complete Neurobagel node setup previously and want to ensure you are using up-to-date instructions and recommended configuration options</li>
<li>Your local node has stopped working after a configuration change to your graph database (e.g., your Neurobagel node API no longer starts or responds with an error, but you have confirmed all environment variables you have set should be correct)</li>
<li>You need to modify credentials for your graph store</li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This action will wipe any graph databases and users you previously created!</p>
</div>
<h2 id="environment-variables-reference">Environment variables reference</h2>
<details class="warning">
<summary>Ensure that shell variables do not clash with <code>.env</code> file</summary>
<p>If the shell you run <code>docker compose</code> from already has any
shell variable of the same name set,
the shell variable will take precedence over the configuration
of <code>.env</code>!
In this case, make sure to <code>unset</code> the local variable first.</p>
<p>For more information, see <a href="https://docs.docker.com/compose/environment-variables/envvars-precedence/">Docker's environment variable precedence</a>.</p>
</details>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Double check that any environment variables you have customized in <code>.env</code> are resolved with your expected values using the command <code>docker compose config</code>.</p>
</div>
<p>Below are all the possible Neurobagel environment variables that can be set in <code>.env</code>.</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Environment variable</th>
<th style="text-align: left;">Default needs change?</th>
<th style="text-align: left;">Description</th>
<th style="text-align: left;">Default value if not set</th>
<th style="text-align: left;">Used in these installation modes</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><code>COMPOSE_PROJECT_NAME</code></td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">(Used only by Docker Compose) Prefix for container names in the deployment; useful when running multiple deployments on the same machine.</td>
<td style="text-align: left;">neurobagel_node</td>
<td style="text-align: left;">Docker</td>
</tr>
<tr>
<td style="text-align: left;"><code>NB_GRAPH_USERNAME</code></td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">Username to set for the graph database user.</td>
<td style="text-align: left;">-</td>
<td style="text-align: left;">Docker, Python</td>
</tr>
<tr>
<td style="text-align: left;"><code>NB_GRAPH_SECRETS_PATH</code></td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">Path to files containing the secure passwords to set for the admin user (NB_GRAPH_ADMIN_PASSWORD.txt) and graph database user (NB_GRAPH_PASSWORD.txt).</td>
<td style="text-align: left;"><code>./secrets</code></td>
<td style="text-align: left;">Docker</td>
</tr>
<tr>
<td style="text-align: left;"><code>NB_GRAPH_DB</code></td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">Name to give your graph database (e.g., for a GraphDB database, use the format <code>repositories/{database_name}</code>)</td>
<td style="text-align: left;"><code>repositories/my_db</code></td>
<td style="text-align: left;">Docker, Python</td>
</tr>
<tr>
<td style="text-align: left;"><code>NB_GRAPH_MEMORY</code></td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">The maximum amount of memory that can be used by graph. Equivalent to setting the <code>-Xmx</code> parameter on the JVM. Value should be a number followed directly by a letter denoting the size. E.g. <code>264m</code> for 264 MB, <code>2g</code> for 2 GB. (For more info, see https://graphdb.ontotext.com/documentation/10.8/requirements.html#hardware-sizing.)</td>
<td style="text-align: left;"><code>2g</code></td>
<td style="text-align: left;">Docker</td>
</tr>
<tr>
<td style="text-align: left;"><code>LOCAL_GRAPH_DATA</code></td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">Path on your filesystem to the JSONLD files you want to upload to the graph database</td>
<td style="text-align: left;"><code>./data</code></td>
<td style="text-align: left;">Docker</td>
</tr>
<tr>
<td style="text-align: left;"><code>NB_GRAPH_PORT_HOST</code></td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Port number on the <em>host machine</em> to map the graph server container port to</td>
<td style="text-align: left;"><code>7200</code></td>
<td style="text-align: left;">Docker</td>
</tr>
<tr>
<td style="text-align: left;"><code>NB_NAPI_ALLOWED_ORIGINS</code></td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Origins allowed to make cross-origin resource sharing requests. Multiple origins must be separated with spaces in a single string enclosed in quotes.</td>
<td style="text-align: left;"><code>""</code></td>
<td style="text-align: left;">Docker, Python</td>
</tr>
<tr>
<td style="text-align: left;"><code>NB_RETURN_AGG</code></td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Whether to return only aggregate, dataset-level query results (excluding subject/session-level attributes). One of [true, false]</td>
<td style="text-align: left;"><code>true</code></td>
<td style="text-align: left;">Docker, Python</td>
</tr>
<tr>
<td style="text-align: left;"><code>NB_MIN_CELL_SIZE</code></td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Minimum number of matching subjects required for a dataset to be returned as a query match. Datasets with matching subjects &lt;= this number will be excluded from query results.</td>
<td style="text-align: left;"><code>0</code></td>
<td style="text-align: left;">Docker, Python</td>
</tr>
<tr>
<td style="text-align: left;"><code>NB_NAPI_TAG</code></td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Docker image tag for the Neurobagel node API</td>
<td style="text-align: left;"><code>latest</code></td>
<td style="text-align: left;">Docker</td>
</tr>
<tr>
<td style="text-align: left;"><code>NB_NAPI_PORT_HOST</code></td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Port number on the <em>host machine</em> to map the Neurobagel node API container port to</td>
<td style="text-align: left;"><code>8000</code></td>
<td style="text-align: left;">Docker</td>
</tr>
<tr>
<td style="text-align: left;"><code>NB_NAPI_BASE_PATH</code></td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">(If using reverse proxy) The URL path where the node API is served from. Do not include a trailing slash.</td>
<td style="text-align: left;"><code>""</code></td>
<td style="text-align: left;">Docker</td>
</tr>
<tr>
<td style="text-align: left;"><code>NB_NAPI_DOMAIN</code></td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">(Production only) The domain name where the n-API will be hosted from</td>
<td style="text-align: left;"><code>""</code></td>
<td style="text-align: left;">Docker</td>
</tr>
<tr>
<td style="text-align: left;"><code>NB_FAPI_TAG</code></td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Docker image tag for the Neurobagel federation API</td>
<td style="text-align: left;"><code>latest</code></td>
<td style="text-align: left;">Docker</td>
</tr>
<tr>
<td style="text-align: left;"><code>NB_FAPI_PORT_HOST</code></td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Port number on the <em>host machine</em> to map the Neurobagel federation API container port to</td>
<td style="text-align: left;"><code>8080</code></td>
<td style="text-align: left;">Docker</td>
</tr>
<tr>
<td style="text-align: left;"><code>NB_FEDERATE_REMOTE_PUBLIC_NODES</code></td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">If "True", include public nodes in federation. If "False", only locally specified nodes in <code>local_nb_nodes.json</code> are queried.</td>
<td style="text-align: left;"><code>true</code></td>
<td style="text-align: left;">Docker, Python</td>
</tr>
<tr>
<td style="text-align: left;"><code>NB_FAPI_BASE_PATH</code></td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">(If using reverse proxy) The URL path where the federation API is served from. Do not include a trailing slash.</td>
<td style="text-align: left;"><code>""</code></td>
<td style="text-align: left;">Docker</td>
</tr>
<tr>
<td style="text-align: left;"><code>NB_FAPI_DOMAIN</code></td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">(Production only) The domain name where the f-API will be hosted from</td>
<td style="text-align: left;"><code>""</code></td>
<td style="text-align: left;">Docker</td>
</tr>
<tr>
<td style="text-align: left;"><code>NB_QUERY_TAG</code></td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Docker image tag for the query tool</td>
<td style="text-align: left;"><code>latest</code></td>
<td style="text-align: left;">Docker</td>
</tr>
<tr>
<td style="text-align: left;"><code>NB_QUERY_PORT_HOST</code></td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">Port number used by the <code>query_tool</code> on the host machine</td>
<td style="text-align: left;"><code>3000</code></td>
<td style="text-align: left;">Docker</td>
</tr>
<tr>
<td style="text-align: left;"><code>NB_API_QUERY_URL</code></td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">(Testing only) URL of the Neurobagel f-API that the query tool will send its requests to. The query tool sends requests from a user's machine, so ensure the API URL is provided <em>as a user would access it from their own machine</em>. See also the <a href="https://github.com/neurobagel/query-tool?tab=readme-ov-file#set-the-environment-variables">query tool README</a>. In a production deployment this variable is ignored.</td>
<td style="text-align: left;">http://localhost:8080</td>
<td style="text-align: left;">Docker</td>
</tr>
<tr>
<td style="text-align: left;"><code>NB_QUERY_APP_BASE_PATH</code></td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">(If using reverse proxy) The URL path for the query tool, determines the specific URL at which the app should be rendered for users to access it</td>
<td style="text-align: left;"><code>/</code></td>
<td style="text-align: left;">Docker</td>
</tr>
<tr>
<td style="text-align: left;"><code>NB_QUERY_DOMAIN</code></td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">(Production only) The domain name where the query tool will be hosted from</td>
<td style="text-align: left;"><code>""</code></td>
<td style="text-align: left;">Docker</td>
</tr>
<tr>
<td style="text-align: left;"><code>NB_CONFIG</code></td>
<td style="text-align: left;">No</td>
<td style="text-align: left;"><strong>(Experimental)</strong> Name of the Neurobagel community configuration to load, if the node uses a community's custom vocabularies.</td>
<td style="text-align: left;"><code>Neurobagel</code></td>
<td style="text-align: left;">Docker, Python</td>
</tr>
<tr>
<td style="text-align: left;"><code>NB_QUERY_HEADER_SCRIPT</code></td>
<td style="text-align: left;">No</td>
<td style="text-align: left;"><strong>(Experimental, for development environments only)</strong> Custom script to add to the header section of the query tool site, such as for a GDPR-aware analytics tool.</td>
<td style="text-align: left;"><code>""</code></td>
<td style="text-align: left;">Docker</td>
</tr>
<tr>
<td style="text-align: left;"><code>NB_ENABLE_AUTH</code></td>
<td style="text-align: left;">No</td>
<td style="text-align: left;"><strong>(Experimental, for development environments only)</strong> Whether to enable authentication for cohort queries. One of [true, false]</td>
<td style="text-align: left;"><code>false</code></td>
<td style="text-align: left;">Docker, Python</td>
</tr>
<tr>
<td style="text-align: left;"><code>NB_QUERY_CLIENT_ID</code></td>
<td style="text-align: left;">No</td>
<td style="text-align: left;"><strong>(Experimental, for development environments only)</strong> OAuth client ID for the query tool. Required if NB_ENABLE_AUTH is set to true.</td>
<td style="text-align: left;">-</td>
<td style="text-align: left;">Docker, Python</td>
</tr>
<tr>
<td style="text-align: left;"><code>COMPOSE_PROFILES</code></td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">(Production only) Selects the production launch profile to use: "node" or "portal". See <a href="https://neurobagel.org/user_guide/production_deployment">the documentation</a> for details.</td>
<td style="text-align: left;"><code>node</code></td>
<td style="text-align: left;">Docker</td>
</tr>
</tbody>
</table>









  




                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../production_deployment_with_own_proxy/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Production deployment with an existing proxy">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Production deployment with an existing proxy
              </div>
            </div>
          </a>
        
        
          
          <a href="../dataset_description/" class="md-footer__link md-footer__link--next" aria-label="Next: Preparing the dataset description">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Preparing the dataset description
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["navigation.footer", "navigation.tabs", "navigation.tabs.sticky", "navigation.indexes", "navigation.expand", "content.tabs.link", "content.code.copy", "content.code.annotate"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="../../js/open_in_new_tab.js"></script>
      
    
  </body>
</html>